<!DOCTYPE html>
<html lang="en" data-version="v1.2.2">
  <head>
    <title>GenieBlocks LoRaWAN OTAA</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="assets/genieblocks-logo.png" type="image/png">
    <link rel="stylesheet" href="css/style.css">
    <script type="module" src="js/script.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.9/jquery.inputmask.min.js"></script>
    <script src="https://unpkg.com/imask"></script>
  </head>
  <body>
    <div id="notSupported" class="notSupported" style="display:none;">
      <div class="bt-warning">
        <span class="bt-warning-icon">&#9888;</span>
        <div class="bt-warning-content">
          <strong>Bu tarayıcı Web Bluetooth API desteği sunmuyor.</strong><br>
          Lütfen Bluetooth ile cihaz konfigürasyonu yapmak için <b>Google Chrome</b> veya Web Bluetooth destekleyen bir tarayıcı kullanın.<br>
          <span style="font-size:0.95em; color:#666;">(Mobilde: Chrome, Android WebView veya Samsung Internet; Masaüstünde: Chrome, Edge, Opera)</span>
        </div>
      </div>
    </div>
    <header class="main-header">
      <img src="assets/genieblocks-logo.png" class="GenieBlocks-Logo">
      <h1>GenieBlocks Bluetooth Cihaz Konfigürasyonu</h1>
    </header>
    <main class="main-content">
      <div class="connection-bar" style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;">
        <span id="connection-status" class="status disconnected">Bağlı Değil</span>
        <button id="butConnect" type="button">Cihaza Bağlan</button>
      </div>

      <!-- Modern, minimal tab menüsü -->
      <div class="tab-container-modern">
        <button class="tab-modern active" data-tab="lorawan">LoRaWAN</button>
        <button class="tab-modern" data-tab="modbus">Modbus</button>
        <button class="tab-modern" data-tab="firmware">Firmware</button>
      </div>

      <div class="tab-content" id="tab-lorawan">
        <form class="otaa-form" autocomplete="off" onsubmit="return false;">
          <div class="form-row">
            <label for="device_eui">Device EUI</label>
            <input type="text" id="device_eui" name="device_eui" autocomplete="off" disabled maxlength="16">
          </div>
          <div class="form-row">
            <label for="app_eui">APP EUI</label>
            <input type="text" id="app_eui" name="app_eui" autocomplete="off" disabled maxlength="16">
          </div>
          <div class="form-row">
            <label for="app_key">APP Key</label>
            <input type="text" id="app_key" name="app_key" autocomplete="off" disabled maxlength="32">
          </div>
          <div class="form-row">
            <label for="platform">Platform</label>
            <input type="text" id="platform" name="platform" autocomplete="off" disabled>
          </div>
          <div class="form-row">
            <label for="freq">Freq</label>
            <input type="text" id="freq" name="freq" autocomplete="off" disabled>
          </div>
          <div class="form-row">
            <label for="pckpo">PckPo</label>
            <input type="text" id="pckpo" name="pckpo" autocomplete="off" disabled>
          </div>
          <div class="form-row">
            <label for="adr">ADR</label>
            <input type="text" id="adr" name="adr" autocomplete="off" disabled>
          </div>
        </form>
      </div>
      <div class="tab-content" id="tab-modbus" style="display:none;">
        <form class="otaa-form" autocomplete="off" onsubmit="return false;">
          <div class="form-row"><label for="mb_addr">Addr</label><input type="number" id="mb_addr" disabled></div>
          <div class="form-row"><label for="mb_baud">Baud</label><input type="text" id="mb_baud" disabled></div>
          <div class="form-row"><label for="mb_parity">Parity</label><input type="number" id="mb_parity" disabled></div>
          <div class="form-row"><label for="mb_stopbits">StopBits</label><input type="number" id="mb_stopbits" disabled></div>
          <div class="form-row"><label for="mb_databits">DataBits</label><input type="number" id="mb_databits" disabled></div>
          <div class="form-row"><label for="mb_timeout">Timeout</label><input type="text" id="mb_timeout" disabled></div>
          <div class="form-row"><label for="mb_polling">Polling</label><input type="text" id="mb_polling" disabled></div>
          <div class="form-row"><label for="mb_func">Func</label><input type="number" id="mb_func" disabled></div>
          <div class="form-row"><label for="mb_regstart">Reg Start</label><input type="number" id="mb_regstart" disabled></div>
          <div class="form-row"><label for="mb_reglen">Reg Len</label><input type="number" id="mb_reglen" disabled></div>
        </form>
      </div>

      <div class="tab-content" id="tab-firmware" style="display:none;" class="tab-pane">
        <form class="firmware-form">
            <div class="firmware-header">
                <h3>Firmware Güncelleme</h3>
                <div class="firmware-info">Cihazın firmware'ini güncellemek için .bin uzantılı dosya seçin.</div>
            </div>
            
            <div class="firmware-controls">
                <div class="file-input-container">
                    <input type="file" id="firmware-file" accept=".bin" disabled>
                    <label for="firmware-file" class="file-input-label">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 1v14M4 9l6-6 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M3 15v2h14v-2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Firmware Dosyası Seç (.bin)
                    </label>
                </div>
                
                <div class="firmware-details" style="display: none;">
                    <div class="detail-row">
                        <span class="detail-label">Dosya:</span>
                        <span id="firmware-filename" class="detail-value">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Boyut:</span>
                        <span id="firmware-size" class="detail-value">-</span>
                    </div>
                </div>
                
                <div class="progress-container" style="display: none;">
                    <div class="progress-header">
                        <span>Yükleme Durumu</span>
                        <span class="progress-text">%0</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="firmware-actions">
                    <button type="button" id="start-upload" class="primary-button" disabled>
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 1v11m-4-4l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M2 13v1h12v-1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Yüklemeyi Başlat
                    </button>
                    <button type="button" id="cancel-upload" class="danger-button" disabled>
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M3 3l10 10m-10 0l10-10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        İptal
                    </button>
                </div>
            </div>
            
            <div class="firmware-log">
                <div class="log-header">
                    <span>İşlem Kayıtları</span>
                    <button type="button" id="clear-firmware-log" class="text-button">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M2 4h12M5 4V2h6v2M4 6v8h8V6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        Temizle
                    </button>
                </div>
                <div id="firmware-log-content"></div>
            </div>
        </form>
    </div>

      <div class="form-row" style="display: flex; align-items: center; gap: 8px; margin-top: 18px;">
        <button id="write_all" disabled>Yaz</button>
        <button id="read_all" type="button" disabled>Oku</button>
        <div style="flex:1"></div>
        <button id="commit_and_restart" type="button" disabled style="margin-left:auto;">Cihazı Yeniden Başlat</button>
      </div>

      <div style="margin-top:18px;text-align:right;">
        <button id="toggleLog">Logu Göster/Gizle</button>
      </div>
      <div id="log" class="log-area"></div>
    </main>
                            <div class="app-version">v1.7.39</div>
  </body>
</html>
